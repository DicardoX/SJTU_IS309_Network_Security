# 网络安全技术 Lecture 7. 公钥基础设施

## 1 数字证书

- 解决“加密者/验证者如何确定公钥匙权威的？”的问题

  - 公钥加密策略中，*sender* 需要使用 *receiver* 的公钥来进行加密，因此必须确定**该公钥确实是 *receiver* 的公钥**
  - 数字签名中，*verifier* 需要使用 *signer* 的公钥来对签名进行验证，因此必须确定  **该公钥确实是 *signer* 的公钥**

- 如何工作？

  - ***CA* 机构** (*Certification Authority*)：持有一个**被假设为广泛知晓的公钥**，被认为是**可信任的第三方 *TTP, Trusted Third Party***

    - *CA* 给每一个公钥持有者发行一个证书，证书内包含：
      
      - 公钥持有者的身份
      - 公钥
      - 证书合法的时间段
      - *CA* 的签名（可以被任何人认证 *CA* 的身份）
    
    $Cert_A = (ID_A, PK_A, expiryDate, Sign_{CA}(ID_A, PK_A, expirtDate))$
    - 通过使用证书，*CA* **保证证书中的公钥由公钥所有者拥有**
    
  - *CA* 发布**证书操作声明 (CPS, *Certification Practice Statement*)** 来指定管理所发行证书所使用的政策（包括责任）

    <img src="./cut/截屏2021-04-06 下午1.04.38.png" alt="avatar" style="zoom:50%;" />

    - **只有 *CA* 才可以创建一个合法的证书**（**需要 *CA* 的私钥，只有 *CA* 才能在证书中生成一个签名**）
    - **任何人都可以使用 *CA* 的公钥来验证证书的权威性**
      - 验证 *CA* 在证书中的签名仅验证 *CA* 担保的证书中公钥和身份之间的绑定有效性
      - **验证 *CA* 签名不会验证证书来源的身份！**，该证书可能由其他攻击者 $A$ 进行了转发
      - **证书是公开的**，常见的格式是 *ITU-T X.509*

  - 一个**安全网页浏览**的例子：

    - **网页浏览器内置了 *CA* 的公钥**
      - Web浏览器软件的合法性对于确保数字证书的安全性至关重要
      - **证书的安全性不比网络浏览器的安全性更高**
    - 实际上，每个浏览器都信任超过一个 *CA* 

    <img src="./cut/截屏2021-04-19 上午10.56.56.png" alt="avatar" style="zoom:35%;" />

  - **证书内包含什么？**

  <img src="./cut/截屏2021-04-19 上午10.59.31.png" alt="avatar" style="zoom:40%;" />

  

- **证书吊销 *CR, Certificate Revocation***：

  - **在某些情况下，必须在证书的有效期之前使证书无效**：
    - 例如，当员工离开组织时，或参与者的私钥已被泄露时
  - **证书吊销列表 *CRL, Certificate Revocation List***：
    - *CA* 应定期或按需分发 *CRL*（由 *CA* 签署），其中列出已撤销证书的序列号
    - 使用证书的参与者应从 *CA* 检查最新的 *CRL*，以确定证书是否仍然有效

--------



## 2 公钥基础结构 *PKI, Public Key Infrastructure*

- **由安全使用公钥密码所需的所有部分组成**

  - 密钥生成和管理，由 *PKI* 生成公钥-私钥对，并将私钥交给被申请者保存，公钥与之保持绑定关系
  - 认证机构 *Certification Authorities*，数字证书 *Digital Certificates*
  - 证书吊销列表 *CRL*

- ***PKI* 没有一般性的标准！**

- 一些 *PKI* 的模型：

  - ***1.* 垄断模式 *Monopoly Model***

    - 已知领域的 *CA* 是一个普遍信任的组织
    - 问题：*CA* 是否被攻破，以及本身能否值得信任

  - ***2.* 无政府状态模型 *Anarchy Model***

    - 每个用户都是 *CA*，用户必须判断哪个 *CA* 值得信任，在 *PGP*（*Pretty Good Privacy*，非常好的隐私）中使用

    - 假设证书由弗兰克（Frank）签名，但我不认识弗兰克（Frank），但我确实相信鲍勃（Bob）和鲍勃（Bob）为弗兰克（Frank）提供担保。 我应该相信弗兰克吗？相信。

    - 假设证书由弗兰克（Frank）签名，但我不认识弗兰克（Frank），但我确实信任鲍勃（Bob），鲍勃（Bob）说爱丽丝（Alice）值得信赖，爱丽丝（Alice）为弗兰克（Frank）担保。 我应该相信弗兰克吗？相信。

    - **Unstructured**：没有具体的结构

      - 假设收到了一个公钥，并声称是爱丽丝的公钥。

      - 公钥和爱丽丝的身份由其他一些（CA）签名。 每个签名都被视为证书：

        <img src="./cut/截屏2021-04-19 上午11.23.01.png" alt="avatar" style="zoom:35%;" />

      - 如果我对鲍勃（Bob），卡罗尔（Carol）和戴夫（Dave）颁发的证书的信任（我已经拥有其有效副本的公钥）分别为1 / 2、1 / 3、1 / 3（并且我没有夏娃的公钥），那么上述爱丽丝的公钥被认为是可信任的，因为 $1/2 + 1/3 + 1/3 > 1$

  - **寡头统治 *Oligarchy***

    - 几个可信任的 *CA*，如今被广泛使用
    - 浏览器可能内置了数十个 *CA* 的公钥
    - 用户可以决定信任哪些CA（默认情况下，您可以信任浏览器信任的 *CA*）

